# Alpha#25: 多因子综合排名策略

## 描述

Alpha#25 的计算公式为：

```
rank(((((-1 * returns) * adv20) * vwap) * (high - close)))
```

该 Alpha 策略包含四个主要组成部分：

1. **回报率反转**:
   * `-1 * returns`: 对回报率取负值，用于捕捉反转机会

2. **成交量加权**:
   * `adv20`: 20日平均成交量，用于衡量流动性
   * `vwap`: 成交量加权平均价格，反映真实交易价格水平

3. **价格差异**:
   * `high - close`: 当日最高价与收盘价的差值，反映日内价格变动

4. **排名标准化**:
   * `rank(...)`: 对所有资产的信号值进行排名，实现跨资产的标准化

## 项目结构

```
alpha-mining/
├── data/
│   ├── generate_mock_data.py  # 脚本：生成模拟金融数据
│   └── mock_data.csv          # 生成的模拟数据文件
├── alpha/alpha25/
│   ├── alpha_calculator.py    # 脚本：根据公式计算 Alpha#25
│   ├── alpha25_results.csv    # 计算得到的 Alpha#25 结果文件
│   ├── README.md              # 本说明文档
│   └── cast.md               # Alpha#25 策略总结
...
```

## 使用步骤

### 1. 环境准备

确保您的 Python 环境中安装了 `pandas` 和 `numpy` 库：

```bash
pip install pandas numpy
```

### 2. 数据准备

本 Alpha 依赖于 `date`, `asset_id`, `high`, `close`, `volume`, `vwap`, `returns` 数据。这些数据应存在于 `../../data/mock_data.csv` 文件中。

### 3. 计算 Alpha#25 因子

进入 `alpha/alpha25` 目录并运行 `alpha_calculator.py` 脚本：

```bash
python alpha_calculator.py
```

## Alpha#25 策略解读与计算示例

以下示例使用 `alpha25_results.csv` 中的实际数据来展示计算过程。我们以 `2025-02-06` 的数据为例：

**背景数据**:
- 日期: `2025-02-06`
- 资产: `asset_3`
- 收盘价 (`close`): `90.5`
- 最高价 (`high`): `95.4`
- 回报率 (`returns`): `-0.0352`
- 20日平均成交量 (`adv20`): `1106227.3`
- 成交量加权价格 (`vwap`): `92.3`
- 最终Alpha值 (`alpha25`): `1.0`（排名后的标准化值）

**计算步骤**:

1. **计算回报率反转**:
   * `-1 * returns = -1 * (-0.0352) = 0.0352`

2. **计算价格差异**:
   * `high - close = 95.4 - 90.5 = 4.9`

3. **计算因子原始值**:
   * `factor = (0.0352 * 1106227.3 * 92.3 * 4.9`
   * `factor = 17611032.418`（这是一个较大的正值，表明信号强度较强）

4. **排名标准化**:
   * 将所有资产的因子值排序
   * 转换为[0,1]区间的排名值
   * 该资产在当日获得最高排名1.0

这个示例展示了一个典型的多因子组合信号：
- 价格出现较大跌幅（负回报率）
- 日内价格波动较大（高低价差距大）
- 成交量和价格水平都处于合理区间
- 最终产生了最强的信号（排名第一）

## 数据需求

- `date`: 交易日期 (YYYY-MM-DD)
- `asset_id`: 资产ID
- `high`: 最高价
- `close`: 收盘价
- `volume`: 成交量
- `vwap`: 成交量加权平均价格
- `returns`: 收益率

## 输出格式

输出的 CSV 文件 (`alpha25_results.csv`) 包含以下列：

- `date`: 交易日期
- `asset_id`: 资产ID
- `high`: 最高价（原始数据）
- `close`: 收盘价（原始数据）
- `returns`: 收益率（原始数据）
- `adv20`: 20日平均成交量（中间计算值）
- `vwap`: 成交量加权平均价格（原始数据）
- `high_close_diff`: 最高价与收盘价的差值（中间计算值）
- `factor`: 排名前的原始因子值（中间计算值）
- `alpha25`: 计算得到的 Alpha#25 值，为[0,1]区间的排名值

## 注意事项与风险提示

1. **数据要求**:
   - 需要至少20天的历史数据来计算平均成交量
   - 需要准确的日内价格和成交量数据
   - 每个资产序列的前19个Alpha值将为NaN

2. **信号特点**:
   - 综合考虑价格、成交量和波动性
   - 通过排名实现跨资产标准化
   - 偏好高流动性、价格回落和可能反转的资产

3. **潜在风险**:
   - 对数据质量要求较高
   - 排名可能受极端值影响
   - 需要足够多的资产才能实现有效排名

4. **实践建议**:
   - 可以调整平均成交量的计算周期（20日）
   - 考虑添加其他价格水平指标
   - 建议结合其他Alpha因子使用 