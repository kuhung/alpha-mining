# Alpha#6: (-1 * correlation(open, volume, 10))

## 描述

Alpha#6 的计算公式为：`(-1 * correlation(open, volume, 10))`

这个 Alpha 策略旨在捕捉开盘价（open）和成交量（volume）在过去10天内的负相关性。当开盘价和成交量的相关性为负，并且这种负相关性越强时，Alpha 的值就越大。这可能意味着当成交量放大时，开盘价有相反的走势（例如，成交量放大伴随开盘价下跌，或成交量萎缩伴随开盘价上涨），反之亦然。

## 项目结构

```
alpha-mining/
├── data/
│   ├── generate_mock_data.py  # 脚本：生成模拟金融数据（包含open, volume字段）
│   └── mock_data.csv          # 生成的模拟数据文件
├── alpha/alpha6/
│   ├── alpha_calculator.py    # 脚本：根据公式计算 Alpha#6
│   ├── alpha6_results.csv     # 计算得到的 Alpha#6 结果文件
│   ├── README.md              # 本说明文档
│   └── cast.md                # Alpha#6 策略总结
```

## 使用步骤

### 1. 环境准备

确保您的 Python 环境中安装了 `pandas` 和 `numpy` 库。如果未安装，可以通过 pip 安装：

```bash
pip install pandas numpy
```

### 2. 生成模拟数据 (如果需要)

本 Alpha 依赖于 `open` 和 `volume` 数据。`data/generate_mock_data.py` 脚本可以生成这些数据。如果 `data/mock_data.csv` 不存在或需要更新：

```bash
cd data
python generate_mock_data.py
cd ..
```
该脚本默认生成5只资产100天的数据。

### 3. 计算 Alpha#6 因子

进入 `alpha/alpha6` 目录并运行 `alpha_calculator.py` 脚本：

```bash
cd alpha/alpha6
python alpha_calculator.py
```

脚本将读取 `../../data/mock_data.csv`，计算 Alpha#6，并将结果保存到当前目录下的 `alpha6_results.csv`。同时会在终端打印部分结果和统计信息。

## Alpha#6 策略解读与计算示例

Alpha#6 是一个**开盘价与成交量短期负相关性因子**。它通过计算过去10天开盘价与成交量的皮尔逊相关系数，并取其相反数，来寻找那些呈现"价量反向"模式的资产。

### 实际数据示例 (asset_1 from alpha6_results.csv)

以下为 `asset_1` 在 `alpha6_results.csv` 中部分日期的计算结果：

| date       | asset_id | open   | volume   | alpha6 |
|------------|----------|--------|----------|--------|
| 2025-01-01 | asset_1  | 100.30 | 690896   | NaN    |
| ...        | ...      | ...    | ...      | ...    |
| 2025-01-09 | asset_1  | 100.71 | 811805   | NaN    |
| 2025-01-10 | asset_1  | 99.45  | 1548483  | 0.03   |
| 2025-01-11 | asset_1  | 99.58  | 539969   | -0.07  |
| 2025-01-12 | asset_1  | 100.42 | 1035398  | -0.07  |
| 2025-01-13 | asset_1  | 98.46  | 1214585  | -0.10  |
| 2025-01-14 | asset_1  | 98.54  | 1277920  | -0.08  |
| 2025-01-15 | asset_1  | 99.38  | 1409656  | -0.08  |
| 2025-01-16 | asset_1  | 95.90  | 791336   | -0.19  |
| 2025-01-17 | asset_1  | 97.88  | 763238   | 0.04   |
| 2025-01-18 | asset_1  | 97.85  | 1487560  | -0.03  |
| 2025-01-19 | asset_1  | 98.31  | 2061421  | -0.09  |
| 2025-01-20 | asset_1  | 97.93  | 1698241  | 0.02   |


### 计算步骤详解 (以 asset_1 在 2025-01-10 为例)

假设我们关注 `asset_1` 在 `2025-01-10` 的 Alpha 值计算。我们需要 `asset_1` 从 `2025-01-01` 到 `2025-01-10` (共10天) 的 `open` 和 `volume` 数据。

1.  **收集数据**:
    *   `open` 序列 (10天): `[100.30, 100.53, 100.88, 101.01, 98.99, 102.35, 100.68, 100.79, 100.71, 99.45]`
    *   `volume` 序列 (10天): `[690896, 1236310, 794092, 1279416, 1327947, 1421350, 2713351, 594738, 811805, 1548483]`

2.  **计算相关性**:
    *   使用上述两个10天长度的序列计算皮尔逊相关系数。
    *   例如，`correlation([100.30, ..., 99.45], [690896, ..., 1548483])` 得到的值约为 `-0.03` (具体数值取决于计算精度，这里仅为示例，实际脚本中 pandas 会精确计算)。

3.  **乘以 -1**:
    *   `alpha6 = -1 * correlation_value`
    *   `alpha6 = -1 * (-0.03) = 0.03`

4.  **结果**:
    *   `asset_1` 在 `2025-01-10` 的 `alpha6` 值为 `0.03`。

### 策略逻辑与解读

*   **高 Alpha 值 (正值)**:
    *   例如 `asset_1` 在 `2025-01-10` 的 Alpha 值为 `0.03`。这表示在过去10天，该资产的开盘价和成交量呈现轻微的负相关性 (`correlation ≈ -0.03`)。当这个 Alpha 值更大时（例如 `0.5`），意味着负相关性更强。
    *   场景：可能是成交量上升时开盘价下跌（放量下跌的开盘），或者成交量萎缩时开盘价上涨（缩量上涨的开盘）。这种模式可能被市场解读为特定信号（如恐慌抛售的开始，或惜售情绪）。

*   **低 Alpha 值 (负值)**:
    *   例如 `asset_1` 在 `2025-01-16` 的 Alpha 值为 `-0.19`。这表示在过去10天，开盘价和成交量呈现正相关性 (`correlation ≈ 0.19`)。
    *   场景：可能是成交量上升时开盘价也上涨（价涨量增的开盘），或者成交量下降时开盘价也下跌（价跌量缩的开盘）。

*   **接近0的Alpha值**:
    *   表明开盘价和成交量在过去10天内的线性关系不强，或接近不相关。

### 实际结果统计 (基于 alpha6_results.csv)

从 `alpha_calculator.py` 脚本运行得到的 `alpha6_results.csv` (共500行，5个资产，100天数据)：
*   **NaN 值数量**: 45 (每个资产的前9天无法计算10日相关性，5 assets * 9 days/asset = 45 NaN)
*   **Alpha6 统计 (排除NaN后共455个值)**:
    *   均值 (mean): ~0.003
    *   标准差 (std): ~0.312
    *   最小值 (min): -0.76
    *   25% 分位数: -0.22
    *   中位数 (50%): 0.01
    *   75% 分位数: 0.24
    *   最大值 (max): 0.80

这些统计数据表明，模拟数据中 Alpha#6 的值分布在 -0.76 到 0.80 之间，均值接近0，表明模拟数据中价量正负相关的情况大致均衡。

## 数据需求
*   每个交易日的 `date`
*   每个资产的 `asset_id`
*   每个交易日的 `open` (开盘价)
*   每个交易日的 `volume` (成交量)

## 输出格式
输出的 CSV 文件将包含以下列：
*   `date`: 交易日期
*   `asset_id`: 资产ID
*   `open`: 当日开盘价 (原始数据)
*   `volume`: 当日成交量 (原始数据)
*   `alpha6`: 计算得到的 Alpha#6 值，保留两位小数。如果因数据不足无法计算相关性，则为 NaN。

## 注意事项与风险提示
*   **数据质量**: 确保输入数据中 `open` 和 `volume` 没有过多缺失值，特别是在计算相关性的窗口期内，否则会导致大量 NaN 输出。
*   **窗口选择**: 相关性的计算对窗口大小（此处为10天）敏感。不同的窗口期可能会捕捉到不同周期的价量关系。
*   **线性关系**: 皮尔逊相关系数主要衡量线性关系，可能无法捕捉复杂的非线性价量模式。
*   **市场环境**: 价量关系可能随市场整体牛熊、特定行业周期或宏观事件而变化，历史统计关系不代表未来。
*   **异常值**: 极端的开盘价或成交量（如因特殊事件导致）可能会扭曲相关性计算，需要考虑异常值处理。
*   **多重共线性**: 在多因子模型中，需注意此Alpha与其他价量因子的潜在共线性。
*   Alpha#6 是基于历史价格和成交量模式的统计策略，不保证未来表现。建议与其他因子结合使用，并进行充分的回测验证。

如需帮助或有建议，欢迎交流！ 